---
title: "Barbell Prediction"
author: "FÃ¡bio Franco Costa"
date: "17/05/2015"
output: html_document
---


You should create a report describing  

* how you built your model,
* how you used cross validation  
* what you think the expected out of sample error is, 
* and why you made the choices you did.  
* You will also use your prediction model to predict 20 different test cases. 

```{r}
# Load packages and set seed
library("caret")
set.seed(666)

# Read Data
pmlData <- read.csv("pml-training.csv")
pmlFinalTest <- read.csv("pml-testing.csv") 

# Filter relevant columns/rows
okCases <- complete.cases(pmlData)

# Convert variables to factor 

# Preprocess training data

# Create trainning datasets
inTrain <- createDataPartition(y = pmlData$classe, p = 0.8, list = F)
trainning <- pmlData[inTrain,]
testing <- pmlData[-inTrain,]

# Setup model parameters
#train_control <- trainControl(method="boot", number=2, allowParallel=TRUE)

# Fit model: random forest
system.time({
modelFit <- train(classe ~ .,
                  data = trainning,
                  #trControl=train_control, ntree=100,
                  verbose=FALSE,
                  method=c("gbm"))
})

# Test the model
predictions <- predict(modelFit, newdata = testing)
confusionMatrix(predictions, testing$classe)

```